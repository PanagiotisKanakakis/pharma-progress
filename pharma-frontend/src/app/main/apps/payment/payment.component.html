<div class="content-wrapper container-xxl p-0" xmlns="http://www.w3.org/1999/html">
    <div class="content-body">
        <!-- Inline Editing Datatables -->
        <section id="ngx-datatable-inline-editing">
            <div class="card">
                <div class="row  mb-50">
                    <div class="col-lg-8">
                        <div class="card-header d-flex justify-content-between align-items-sm-center align-items-start flex-md-row flex-column">
                            <div class="header-right d-flex align-items-center mt-sm-0 mt-1"
                                 style="width: -webkit-fill-available;">
                                <i class="font-medium-5" data-feather="calendar"></i>
                                <ng2-flatpickr class="font-weight-bolder" [config]="DateRangeOptions"
                                               style="width: inherit"
                                               name="DateRange"></ng2-flatpickr>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4">
                        <div class="col-12">
                            <button class="btn btn-primary ml-1" style="float: right; margin-top: 20px;" rippleEffect
                                    (click)="initTransaction()">
                                <i data-feather="plus" class="mr-0 mr-sm-1"></i>
                                <span class="d-none d-sm-inline-block">{{ 'BUTTON.ADD_NEW_RECORD' | translate }}</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            <core-card>
                <div class="card card-statistics">
                    <div class="card-body statistics-body">
                        <div class="row">
                            <div class="col-xl-12 col-md-12 col-12">
                                <div class="card card-company-table">
                                    <div class="card-body p-0">
                                        <div class="table-responsive">
                                            <table class="table table-striped table-dark table-borderless">
                                                <thead>
                                                <tr>
                                                    <th class="text-center" style="color: white!important;">
                                                        {{'TABLE.CATEGORY' | translate}}
                                                    </th>
                                                    <th *ngIf="type !== 'taxes'" class="text-center" style="color: white!important;">
                                                        {{'TABLE.PAYMENT_TYPE' | translate}}
                                                    </th>
                                                    <th class="text-center" style="color: white!important;">
                                                        {{'TABLE.DATE' | translate}}
                                                    </th>
                                                    <th class="text-center" style="color: white!important;">
                                                        {{'TABLE.VALUE' | translate}}
                                                    </th>
                                                    <th class="text-center" style="color: white!important;">
                                                        {{'TABLE.DESCRIPTION' | translate}}
                                                    </th>
                                                    <th class="text-center" style="color: white!important;">
                                                        {{'TABLE.ACTION' | translate}}
                                                    </th>
                                                </tr>
                                                </thead>
                                                <tbody>
                                                <tr *ngFor="let row of rows;let rowIndex=index;">
                                                    <td>
                                                        <div class="block btn btn-btn-success accent-4"
                                                             style="white-space: nowrap;margin-left: 5px;width: available">
                                                            {{row.category | translate}}
                                                        </div>
                                                    </td>
                                                    <td *ngIf="type !== 'taxes'">
                                                        <select *ngIf="row.id === undefined"
                                                                class="form-control form-control-lg block btn-btn-success accent-4"
                                                                #selectElement
                                                                (change)='onOptionsSelected(selectElement.value, rowIndex)'>
                                                            <option value="{{'TABLE.OPTION_DEFAULT_PAYMENT_SELECT' | translate}}"
                                                                    selected="selected"
                                                                    disabled="disabled">{{'TABLE.OPTION_DEFAULT_PAYMENT_SELECT' | translate}}</option>
                                                            <option value="Μετρητά">Μετρητά</option>
                                                            <option value="Τράπεζα">Τράπεζα</option>
                                                        </select>
                                                        <div *ngIf="row.id !== undefined"
                                                             style="white-space: nowrap;margin-left: 5px;width: available"
                                                             class="block btn btn-btn-success accent-4"
                                                        >
                                                            {{row.paymentType}}
                                                        </div>
                                                    </td>
                                                    <td>
                                                        <div title="Double click to edit"
                                                             class="text-center"
                                                             (dblclick)="editingDateValue[rowIndex] = true"
                                                             *ngIf="!editingDateValue[rowIndex]"
                                                             style="font-weight: bold;font-size: 13px;">
                                                            {{row.createdAt}}
                                                        </div>
                                                        <input autofocus
                                                               type="text"
                                                               class="form-control"
                                                               placeholder="dd-mm-yyyy"
                                                               *ngIf="editingDateValue[rowIndex]"
                                                               (blur)="parseDate($event,rowIndex)"
                                                               [formControl]="dateFormControl[rowIndex]">
                                                        <span *ngIf="!dateFormControl[rowIndex].valid"
                                                              class="invalid-form">
                                                            <small class="form-text text-muted danger"
                                                                   *ngIf="dateFormControl[rowIndex].errors?.pattern">
                                                                {{'TABLE.DATE_PATTERN' | translate}}
                                                            </small>
                                                            <small class="form-text text-muted danger"
                                                                   *ngIf="dateFormControl[rowIndex].errors?.range">
                                                                {{'TABLE.DATE_LIMIT' | translate}}
                                                            </small>
                                                        </span>
                                                    </td>
                                                    <td>
                                                        <div title="Double click to edit"
                                                             class="text-center"
                                                             (click)="editingValue[rowIndex] = true"
                                                             *ngIf="!editingValue[rowIndex]">
                                                            {{row.cost}}€
                                                        </div>
                                                        <input autofocus
                                                               class="form-control form-control-sm"
                                                               (blur)="inlineEditingUpdateValue($event,rowIndex)"
                                                               *ngIf="editingValue[rowIndex]"
                                                               type="number"
                                                               [formControl]="numberFormControl[rowIndex]"
                                                        />
                                                        <span *ngIf="!numberFormControl[rowIndex].valid"
                                                              class="invalid-form">
                                                            <small class="form-text text-muted danger"
                                                                   *ngIf="numberFormControl[rowIndex].errors?.required">
                                                                            {{'TABLE.NUMBER_REQUIRED' | translate}}
                                                            </small>
                                                            <small class="form-text text-muted danger"
                                                                   *ngIf="numberFormControl[rowIndex].errors?.min">
                                                                            {{'TABLE.NUMBER_PATTERN' | translate}}
                                                            </small>
                                                        </span>
                                                    </td>
                                                    <td class="text-nowrap">
                                                        <input type="text" class="form-control">
                                                    </td>
                                                    <td>
                                                        <div *ngIf="row.id == undefined"
                                                             class="align-items-center text-center"
                                                             (click)="removeRow(rowIndex)">
                                                            <i data-feather="trash-2"
                                                               class="text-primary cursor-pointer"></i>
                                                        </div>
                                                        <div *ngIf="row.id != undefined"
                                                             class="align-items-center text-center">
                                                            -
                                                        </div>
                                                    </td>
                                                </tr>
                                                </tbody>
                                                <tfoot>
                                                <tr>
                                                    <td>
                                                        Σύνολο:  {{ summaryColumn() }}€
                                                    </td>
                                                </tr>
                                                </tfoot>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </core-card>
        </section>
    </div>
</div>
